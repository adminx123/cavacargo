<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Quote Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            max-width: 600px;
            margin: auto;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input, select {
            width: 100%;
            padding: 5px;
            margin-bottom: 10px;
        }
        button {
            grid-column: span 2;
            padding: 10px;
        }
        .vent-status {
            grid-column: span 2;
            display: none;
        }
        .infestation-label {
            grid-column: 1 / 2;
        }
        .infestation-note {
            grid-column: 2 / 3;
        }
    </style>
</head>
<body>

<h1 style="font-size:14px;">Cavacargo</h1>
<h1 style="font-size:14px;">xxx-xxx-xxxx</h1>
<h1 style="font-size:14px;">admin@cavacargo.com</h1>

<h1 style="font-size:24px; text-align:center;">Dryer Vent Cleaning</h1>
<div class="container">
    <label for="standardFee">Standard Fee</label>
    <select id="standardFee" onchange="calculateQuote()">
        <option value="100">$100</option>
    </select>
    
    <label for="serviceLocation">Location</label>
    <select id="serviceLocation" onchange="calculateQuote()">
        <option value="Fairview">Fairview</option>
        <option value="Kerrisdale">Kerrisdale</option>
        <option value="Kitsilano">Kitsilano</option>
        <option value="Mount Pleasant">Mount Pleasant</option>
        <option value="Shaughnessy">Shaughnessy</option>
        <option value="Spanish Banks">Spanish Banks</option>
        <option value="UBC">UBC</option>
    </select>

    <label for="ventLength">Vent Length</label>
    <select id="ventLength" onchange="calculateQuote()">
        <option value="0-15 ft">0-15</option>
        <option value="16-25 ft">16-25</option>
        <option value="26-x ft">26 - X</option>
    </select>

    <label for="ventLocation">Vent Location</label>
    <select id="ventLocation" onchange="calculateQuote()">
        <option value="groundLevel">Ground Level</option>
        <option value="roof">Roof *Sorry we are unable to service roof vents at this time.</option>
        <option value="ladderAccessible">Ladder Accessible + $20</option>
    </select>
    
    <label for="ventQTY">Vents</label>
    <select id="ventQTY" onchange="calculateQuote()">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
    </select>

    <label for="ventElbow">Vent Elbows</label>
    <select id="ventElbow" onchange="calculateQuote()">
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
    </select>

    <label for="damagedVenting">Vent Damage</label>
    <select id="damagedVenting" onchange="calculateQuote()">
        <option value="ventUnsure">No/Unsure + $0-TBD</option>
        <option value="FH">Replacement Flexible Hose + $30</option>
        <option value="MVT">Minor Vent Taping + $0</option>
        <option value="EVC">Exterior Vent Cover + $25</option>
    </select>

    <label for="RodentInfestation">Rodent Infestation</label>
    <select id="RodentInfestation" onchange="calculateQuote()">
        <option value="rodentUnsure">No/Unsure + $0-25</option>
        <option value="rodentYes">Yes + $25</option>
    </select>

<button id="calculateEstimate">Calculate Estimate</button>


    <button id="sendEmail">Request Quote</button>
    <p id="quoteResult"></p>
    <p id="note"></p>
</div>

<script>
   function calculateQuote() {
    const standardFee = parseFloat(document.getElementById('standardFee').value);
    const serviceLocation = document.getElementById('serviceLocation').value;
    const ventLength = document.getElementById('ventLength').value;
    const ventLocation = document.getElementById('ventLocation').value;
    const ventQTY = document.getElementById('ventQTY').value;
    const ventElbow = document.getElementById('ventElbow').value;
    const damagedVenting = document.getElementById('damagedVenting').value;
    const rodentInfestation = document.getElementById('RodentInfestation').value;

    let quote = standardFee;

    switch (serviceLocation) {
        case 'Fairview': quote += 15; break;
        case 'Kerrisdale': quote += 20; break;
        case 'Mount Pleasant': quote += 30; break;
        case 'Shaughnessy': quote += 15; break;
        case 'Kitsilano': quote += 20; break;
        case 'Spanish Banks': quote += 30; break;
        case 'UBC': quote += 35; break;
    }

    switch (ventLength) {
        case '0-15 ft': quote += 10; break;
        case '16-25 ft': quote += 20; break;
        case '26-x ft': quote += 30; break;
    }

    switch (ventLocation) {
        case 'roof': quote += 0; break;
        case 'groundLevel': quote += 0; break;
        case 'ladderAccessible': quote += 20; break;
    }
    
    switch (ventQTY) {
        case '1': quote += 10; break;
        case '2': quote += 20; break;
        case '3': quote += 30; break;
    }
    
    switch (ventElbow) {
        case '0': quote += 0; break;
        case '1': quote += 10; break;
        case '2': quote += 20; break;
        case '3': quote += 30; break;
    }

    switch (damagedVenting) {
        case 'EVC': quote += 25; break;
        case 'FH': quote += 30; break;
        case 'MVT': quote += 0; break;
        case 'ventUnsure': quote += 0; break;
    }

    switch (rodentInfestation) {
        case 'rodentUnsure': quote += 0; break;
        case 'rodentYes': quote += 25; break;
    }

    return {
        quote: quote.toFixed(2),
        serviceLocation,
        ventLength,
        ventQTY,
        ventElbow,
        ventLocation,
        damagedVenting,
        rodentInfestation
    };
}

document.getElementById('calculateEstimate').addEventListener('click', () => {
    const result = calculateQuote();

    document.getElementById('quoteResult').innerText = 'Estimated Quote: $' + result.quote;

    // Update the note based on damaged venting and rodent infestation status
    document.getElementById('note').innerText =
        'Note: ' +
        (result.damagedVenting === 'ventUnsure' ? 'Damage Inspection Needed' : '') +
        (result.damagedVenting === 'ventUnsure' && result.rodentInfestation === 'rodentUnsure' ? ' and ' : '') +
        (result.rodentInfestation === 'rodentUnsure' ? 'Rodent Inspection Needed' : '');
});

document.getElementById('sendEmail').addEventListener('click', () => {
    const result = calculateQuote();

    const emailSubject = encodeURIComponent('Service Request');
    const emailBody = encodeURIComponent(`
        Cavacargo
        Phone: xxx-xxx-xxxx
        Email: admin@cavacargo.com

        Please complete any information missing below.

        Name:
        Phone Number:
        Service Area: ${result.serviceLocation}
        Service Address:
        Vent Length: ${result.ventLength}
        Vent Quantity: ${result.ventQTY}
        Vent Elbows: ${result.ventElbow}
        Vent Location: ${result.ventLocation}
        Damaged Venting: ${result.damagedVenting}
        Rodent Infestation: ${result.rodentInfestation}

        Quoted Price: $${result.quote}
    `);

    // Construct the mailto link
    const mailtoLink = `mailto:admin@cavacargo.com?subject=${emailSubject}&body=${emailBody}`;

    // Open the default email client
    window.open(mailtoLink);
});

</script>

</body>
</html>
